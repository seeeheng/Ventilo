<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../../../Leaflet/leaflet.css"
          crossorigin=""/>
    <link rel="stylesheet" href="../../../js/leaflet-bft.css"
          crossorigin=""/>

    <script src="../../../Leaflet/leaflet.js"
            crossorigin=""></script>
    <script src="../../../js/anglemarker-plugin.js"
            crossorigin=""></script>
    <script src="../../../js/leaflet-fastmap-bft.js"
            crossorigin=""></script>
    <script src="../../../js/stomp.js"
            crossorigin=""></script>
    <script src="../../../js/bft-fastmap-tracks-decks.js"
            crossorigin=""></script>

    <title>BFT Web Map - Leaflet</title>
</head>
<body>
Deck 2 (Poop)
<div id="mapdeck"></div>


<script>
    var averageHeightInMetres = $averageHeightInMetres;
    var lowestHeight= $averageHeightInMetres - 3;
    var highestHeight= $averageHeightInMetres + 3;
    var level = $level;
    var gaScale = $gaScale; // GA scale
    var pxWidth = $pxWidth; //Width of GA cut out
    var pxHeight = $pxHeight; //Height of GA cut out
    var factor = 1/gaScale;
    var imageoverlay = $imageOverlayFilePath; // for e.g. '../ship/DECK2.png'
    var lowerleftx = $lowerLeftX;
    var lowerlefty = $lowerLeftY;
    var upperrightx = $upperRightX;
    var upperrighty = $upperRightY;
    var initialx = $initialX;
    var initialy = $initialY;
    <!-- var initialzoom = 0.2 * gaScale / factor; -->
    var initialzoom = $initialZoom;
    var map0 = loadLeaflet(imageoverlay,lowerleftx,lowerlefty,upperrightx,upperrighty, initialx,initialy,initialzoom);

    // getCustomMarker(0,0,null,'P0',true,0).addTo(map0);
    // getCustomMarker(5.44*250/100,0,null,'P20',true,0).addTo(map0);
    // getCustomMarker(11.84*250/100,0,null,'P40',true,0).addTo(map0);
    // getCustomMarker(18.24*250/100,0,null,'P60',true,0).addTo(map0);
    // getCustomMarker(37.43*250/100,0,null,'P120',true,0).addTo(map0);
    // getCustomMarker(43.82*250/100,0,null,'P140',true,0).addTo(map0);
    // getCustomMarker(50.21*250/100,0,null,'P160',true,0).addTo(map0);
    // getCustomMarker(55.99*250/100,0,null,'P180',true,0).addTo(map0);
    // getCustomMarker(61.37*250/100,0,null,'P200',true,0).addTo(map0);
    // getCustomMarker(66.16*250/100,0,null,'P220',true,0).addTo(map0);

    var mqSettings=Android.getMQSettings();
    mqSettingsArray=mqSettings.split(',');
    mqAddress=mqSettingsArray[0];
    mqUser=mqSettingsArray[1];
    mqPassword=mqSettingsArray[2];
    mqTopic=mqSettingsArray[3];
    mqPort=mqSettingsArray[4];
    //mqAddress=parent.document.getElementById('txtboxRabbitMQserver').value;
    //mqUser=parent.document.getElementById('txtboxRabbitMQuser').value;
    //mqPassword=parent.document.getElementById('txtboxRabbitMQpassword').value;
    //mqTopic=parent.document.getElementById('txtboxRabbitMQtopic').value;
    // console.debug("mqAddress",mqAddress);
    // console.debug("mqUser",mqUser);
    // console.debug("mqPassword",mqPassword);
    // console.debug("mqTopic",mqTopic);
    initRabbit(mqAddress,mqUser,mqPassword,mqTopic,mqPort);

    map0.on('contextmenu', function(e){
        console.debug("deck 2", "long press");
        var x=e.latlng.lng;
        var y=e.latlng.lat;
        <!--mapHeight=((highestHeight-lowestHeight)/2)+lowestHeight;-->
        mapHeight = averageHeightInMetres;
        var xyInPixelszInMetres = x + "," + y + "," + mapHeight;

        var iconType = Android.getIconTypeToMarker();
        if (iconType == Android.getHazardString() || iconType == Android.getDeceasedString()) {
            console.debug("iconType",iconType);
            Android.setCurrentCoordMsg(xyInPixelszInMetres, iconType);
            <!--var currentCoordMsg = Android.getCurrentCoordMsg(xyInPixelszInMetres, iconType);-->
            <!--androidToJScreateLocation(currentCoordMsg);-->
        } else {
            console.debug("manualLocationUpdateinPixels","manualLocationUpdateinPixels");
            Android.manualLocationUpdateinPixels(xyInPixelszInMetres);
        }
    });

</script>
</body>
</html>